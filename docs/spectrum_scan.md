# H(s) のスペクトル解析と最小ギャップ Δ_min の物理的意味

本ドキュメントでは、量子アニーリングで最も重要となる  
**エネルギーギャップの計算（spectrum_scan）** について解説する。

---

## 1. 量子アニーリングにおける時間依存ハミルトニアン

量子アニーリングでは、

\[
H(s) = A(s) H_d + B(s) H_p^Q,
\quad s \in [0, 1]
\]

という時間依存ハミルトニアンを用いる。

- \(H_d = -\sum_i \sigma_i^x\)：ドライバーハミルトニアン  
  - 初期状態が簡単（x方向に揃った重ね合わせ）

- \(H_p^Q\)：問題ハミルトニアン  
  - 古典イジングのエネルギー関数を量子化したもの

最終的に \(s=1\) のときの基底状態が  
求めたい最適解に対応する。

---

## 2. エネルギーギャップ Δ(s)

ハミルトニアン \(H(s)\) の固有値を

\[
E_0(s) \le E_1(s) \le E_2(s) \le \cdots
\]

と並べたとき、

\[
\Delta(s) = E_1(s) - E_0(s)
\]

を **エネルギーギャップ** と呼ぶ。

量子アニーリングの成否は、  
最小ギャップ

\[
\Delta_{\min} = \min_{s \in [0,1]} \Delta(s)
\]

の大きさに強く依存する。

---

## 3. アディアバティック条件（成功条件）

量子アニーリングが「基底状態を保ったまま最終状態に到達」するには、

\[
T_{\mathrm{anneal}} \gg \frac{1}{\Delta_{\min}^2}
\]

という条件（アディアバティック条件）が必要とされる。

つまり：

- **ギャップが小さいほど**  
  → **ゆっくりアニーリングしないと励起状態に飛んでしまう**

- 特に最小ギャップ付近（典型的には \(s \approx 0.5\)〜0.8）で  
  アニーリングが最も難しくなる。

---

## 4. spectrum_scan.py の役割

本プロジェクトの `spectrum_scan.py` は

\[
s = 0, 0.05, 0.10, \ldots, 1.0
\]

の離散点で

1. \(H(s)\) を構築  
2. 固有値を数値対角化  
3. \(E_0(s), E_1(s), \Delta(s)\) をリスト化  
4. 最小ギャップ \(\Delta_{\min}\) とその位置 \(s_{\min}\) を特定  

するスクリプトである。

---

## 5. 実行例の解釈

例：
```sh
Minimum gap Δ_min ≈ 0.140981 at s ≈ 0.650
```

→ このイジング問題では

- \(s \approx 0.65\) で基底状態と第1励起状態が最も接近
- 量子アニーリングはこの区間で最も失敗しやすい

---

## 6. なぜスペクトルを見ることが重要か？

古典 SA には「エネルギーバリア」「温度スケジュール」が重要であるように、

量子アニーリングには：

- **エネルギーギャップ**
- **交差する固有値の挙動**
- **スケジューリング A(s), B(s)**

が性能を決める。

したがって、  
**古典解法 vs 量子解法の比較には、ギャップ構造を調べることが不可欠**。

---

## 7. まとめ

- spectrum_scan.py は量子アニーリングの難しさを示す  
  **最小ギャップ Δ_min** を評価するためのスクリプトである

- 得られた Δ_min は  
  - QA の必要アニーリング時間  
  - SA との比較  
  - 問題の難易度の特徴量  
  として利用できる

- 小さい N でも、  
  **量子イジングの「本質的な振る舞い」**を確認できる

